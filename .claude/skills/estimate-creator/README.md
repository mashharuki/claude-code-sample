# 御見積書作成スキル

原価と粗利率から販売単価を自動計算し、プロフェッショナルな見積書(Excel形式)を生成するスキルです。

## 機能

- 原価と粗利率から販売単価を自動計算
- Excel形式の正式な見積書を生成
- 消費税(10%)の自動計算
- 原価情報は見積書に記載しない(機密保持)

## 必要な環境

### Pythonライブラリ

```bash
pip install openpyxl
```

## 使用方法

### Claude Codeでの使用

見積書を作成したい場合、以下のように依頼してください:

```
見積書を作成してください。
- 日付: 20240115
- クライアント: 株式会社サンプル
- 件名: ウェブサイト制作
- 支払条件: 納品後30日以内
- 粗利率: 30%
- 項目:
  - デザイン作成 / 1 / 式 / 原価50000円
  - コーディング / 1 / 式 / 原価80000円
```

### コマンドラインでの直接実行

```bash
# 設定ファイルを作成
cat > estimate_config.json << 'EOF'
{
  "output_path": "001_御見積書/20240115_御見積書_ウェブサイト制作.xlsx",
  "date": "20240115",
  "client_name": "株式会社サンプル",
  "subject": "ウェブサイト制作",
  "payment_terms": "納品後30日以内",
  "gross_margin_rate": 30,
  "items": [
    {
      "name": "デザイン作成",
      "quantity": 1,
      "unit": "式",
      "unit_cost": 50000
    },
    {
      "name": "コーディング",
      "quantity": 1,
      "unit": "式",
      "unit_cost": 80000
    }
  ]
}
EOF

# スクリプト実行
python .claude/skills/estimate-creator/scripts/create_estimate.py estimate_config.json
```

## 計算ロジック

### 販売単価の計算式

```
販売単価 = 原価 ÷ (1 - 粗利率/100)
```

### 計算例

| 原価 | 粗利率 | 計算 | 販売単価 |
|------|--------|------|----------|
| 10,000円 | 30% | 10,000 ÷ 0.70 | 14,286円 |
| 50,000円 | 25% | 50,000 ÷ 0.75 | 66,667円 |
| 80,000円 | 40% | 80,000 ÷ 0.60 | 133,333円 |

## 出力ファイル

### ファイル名形式

```
001_御見積書/YYYYMMDD_御見積書_{案件名}.xlsx
```

例:
- `001_御見積書/20240115_御見積書_ウェブサイト制作.xlsx`
- `001_御見積書/20240201_御見積書_システム開発.xlsx`

### Excelファイルの内容

生成される見積書には以下の情報が含まれます:

1. **ヘッダー情報**
   - タイトル: 御見積書
   - 発行日
   - クライアント名
   - 件名
   - 支払条件

2. **明細表**
   - No. (連番)
   - 項目名
   - 数量
   - 単位
   - 単価(販売単価のみ、原価は非表示)
   - 金額

3. **合計情報**
   - 合計金額(税抜)
   - 消費税(10%)
   - 総合計(税込)

4. **備考**
   - 標準的な備考文

## セキュリティ

### 原価の機密保持

**重要**: 原価情報は社外秘情報として扱われます。

- 原価は計算にのみ使用され、見積書には**絶対に記載されません**
- 見積書に記載されるのは「販売単価」のみです
- 粗利率も見積書には記載されません

## サンプル

### 入力例

```json
{
  "output_path": "001_御見積書/20240115_御見積書_ウェブサイト制作.xlsx",
  "date": "20240115",
  "client_name": "株式会社サンプル",
  "subject": "ウェブサイト制作一式",
  "payment_terms": "納品後30日以内にお振込みください",
  "gross_margin_rate": 30,
  "items": [
    {
      "name": "トップページデザイン",
      "quantity": 1,
      "unit": "式",
      "unit_cost": 50000
    },
    {
      "name": "下層ページデザイン",
      "quantity": 5,
      "unit": "ページ",
      "unit_cost": 20000
    },
    {
      "name": "レスポンシブコーディング",
      "quantity": 1,
      "unit": "式",
      "unit_cost": 80000
    },
    {
      "name": "お問い合わせフォーム実装",
      "quantity": 1,
      "unit": "式",
      "unit_cost": 30000
    }
  ]
}
```

### 計算結果

| 項目 | 数量 | 単位 | 原価(非表示) | 販売単価 | 金額 |
|------|------|------|--------------|----------|------|
| トップページデザイン | 1 | 式 | 50,000円 | 71,429円 | 71,429円 |
| 下層ページデザイン | 5 | ページ | 20,000円 | 28,571円 | 142,855円 |
| レスポンシブコーディング | 1 | 式 | 80,000円 | 114,286円 | 114,286円 |
| お問い合わせフォーム実装 | 1 | 式 | 30,000円 | 42,857円 | 42,857円 |

- **小計(税抜)**: 371,427円
- **消費税(10%)**: 37,143円
- **合計(税込)**: 408,570円

## ファイル構成

```
.claude/skills/estimate-creator/
├── SKILL.md              # スキル定義ファイル
├── README.md             # 本ファイル(使用方法)
├── scripts/
│   └── create_estimate.py  # 見積書生成スクリプト
└── examples/
    └── sample_config.json  # サンプル設定ファイル
```

## トラブルシューティング

### openpyxlがインストールされていない

```bash
pip install openpyxl
```

### 粗利率のエラー

粗利率は0%より大きく、100%未満である必要があります。

適切な範囲: 5% 〜 50% (一般的)

### ファイルが上書きされる

同じファイル名で実行すると、既存のファイルが上書きされます。
日付や案件名を変更して別のファイル名にしてください。

## ライセンス

このスキルはプロジェクト内部での使用を目的としています。
